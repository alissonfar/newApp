{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Alisson\\\\Desktop\\\\NEWAPP CONTROLE FINANCEIRO\\\\controle-gastos-frontend\\\\src\\\\components\\\\Transaction\\\\NovaTransacaoForm.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef, useMemo, useCallback } from 'react';\nimport { criarTransacao, atualizarTransacao, obterCategorias, obterTags } from '../../api';\nimport './NovaTransacaoForm.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NovaTransacaoForm = ({\n  onSuccess,\n  onClose,\n  transacao\n}) => {\n  _s();\n  // Estados dos dados gerais\n  const [tipo, setTipo] = useState(transacao ? transacao.tipo : 'gasto');\n  const [descricao, setDescricao] = useState(transacao ? transacao.descricao : '');\n  const [data, setData] = useState(transacao ? transacao.data.split('T')[0] : '');\n  const [valorTotal, setValorTotal] = useState(transacao ? String(transacao.valor) : '');\n  const descricaoSuggestions = ['Compra de pizza', 'Pagamento de conta', 'Arbitragem'];\n\n  // Pagamentos (cada pagamento terá tags)\n  const [pagamentos, setPagamentos] = useState(transacao && transacao.pagamentos && transacao.pagamentos.length > 0 ? transacao.pagamentos : [{\n    pessoa: '',\n    valor: '',\n    paymentTags: {}\n  }]);\n  const pessoaSuggestions = ['Eu', 'Alisson', 'Emerson'];\n\n  // Categorias e tags (para dropdowns)\n  const [categorias, setCategorias] = useState([]);\n  const [allTags, setAllTags] = useState([]);\n  const descricaoRef = useRef(null);\n  const dataRef = useRef(null);\n  const valorRef = useRef(null);\n\n  // Centraliza o campo em foco\n  const handleFocus = e => {\n    e.target.scrollIntoView({\n      behavior: 'smooth',\n      block: 'center'\n    });\n  };\n\n  // Carrega categorias e tags do backend\n  useEffect(() => {\n    async function fetchData() {\n      try {\n        const cats = await obterCategorias();\n        setCategorias(cats);\n        const tgs = await obterTags();\n        setAllTags(tgs);\n      } catch (error) {\n        console.error('Erro ao carregar categorias ou tags:', error);\n      }\n    }\n    fetchData();\n    if (!transacao) {\n      const hoje = new Date().toISOString().split('T')[0];\n      setData(hoje);\n    }\n  }, [transacao]);\n\n  // Agrupa as tags por categoria (recalculado apenas quando allTags muda)\n  const tagsPorCategoria = useMemo(() => {\n    return allTags.reduce((acc, tag) => {\n      if (tag.categoria) {\n        if (!acc[tag.categoria]) {\n          acc[tag.categoria] = [];\n        }\n        acc[tag.categoria].push(tag.nome);\n      }\n      return acc;\n    }, {});\n  }, [allTags]);\n\n  // Manipulação dos pagamentos com useCallback para evitar recriação\n  const handlePagamentoChange = useCallback((index, field, value) => {\n    setPagamentos(prev => {\n      const novosPagamentos = [...prev];\n      novosPagamentos[index] = {\n        ...novosPagamentos[index],\n        [field]: value\n      };\n      return novosPagamentos;\n    });\n  }, []);\n  const handlePagamentoTagChange = useCallback((index, categoria, selectedOptions) => {\n    setPagamentos(prev => {\n      const novosPagamentos = [...prev];\n      const currentTags = novosPagamentos[index].paymentTags || {};\n      novosPagamentos[index] = {\n        ...novosPagamentos[index],\n        paymentTags: {\n          ...currentTags,\n          [categoria]: selectedOptions\n        }\n      };\n      return novosPagamentos;\n    });\n  }, []);\n  const addPagamento = () => {\n    setPagamentos(prev => [...prev, {\n      pessoa: '',\n      valor: '',\n      paymentTags: {}\n    }]);\n  };\n  const removePagamento = index => {\n    setPagamentos(prev => prev.filter((_, i) => i !== index));\n  };\n\n  // Replica o valor total para o único pagamento, se houver apenas um\n  const handleValorTotalChange = e => {\n    const raw = e.target.value;\n    setValorTotal(raw);\n    if (pagamentos.length === 1) {\n      handlePagamentoChange(0, 'valor', raw);\n    }\n  };\n\n  // Validação: a soma dos pagamentos deve ser igual ao valor total\n  const validatePagamentos = () => {\n    const soma = pagamentos.reduce((acc, pag) => {\n      const v = parseFloat(pag.valor || 0);\n      return acc + (isNaN(v) ? 0 : v);\n    }, 0);\n    return parseFloat(valorTotal || 0) === soma;\n  };\n\n  // ENVIAR FORMULÁRIO: definido antes do useEffect que o utiliza\n  const handleSubmit = useCallback(async (e, closeModal = true) => {\n    e.preventDefault();\n    if (!validatePagamentos()) {\n      alert('A soma dos pagamentos deve ser igual ao valor total.');\n      return;\n    }\n    const transacaoData = {\n      tipo,\n      descricao,\n      data: new Date(data).toISOString(),\n      valor: Number(parseFloat(valorTotal).toFixed(2)),\n      tags: {},\n      pagamentos: pagamentos.map(pag => ({\n        pessoa: pag.pessoa,\n        valor: Number(parseFloat(pag.valor).toFixed(2)),\n        tags: pag.paymentTags\n      }))\n    };\n    try {\n      if (transacao && transacao.id) {\n        await atualizarTransacao(transacao.id, transacaoData);\n        alert('Transação atualizada com sucesso!');\n      } else {\n        await criarTransacao(transacaoData);\n        alert('Transação criada com sucesso!');\n      }\n      if (onSuccess) onSuccess();\n      if (closeModal) {\n        onClose();\n      } else {\n        // Reseta os campos para nova inserção\n        setTipo('gasto');\n        setDescricao('');\n        const hoje = new Date().toISOString().split('T')[0];\n        setData(hoje);\n        setValorTotal('');\n        setPagamentos([{\n          pessoa: '',\n          valor: '',\n          paymentTags: {}\n        }]);\n      }\n    } catch (error) {\n      console.error('Erro ao salvar transação:', error);\n      alert('Erro ao salvar transação.');\n    }\n  }, [tipo, descricao, data, valorTotal, pagamentos, transacao, onSuccess, onClose]);\n\n  // Atalho: Ctrl+S para salvar\n  useEffect(() => {\n    const handleKeyDown = e => {\n      if (e.ctrlKey && e.key === 's') {\n        e.preventDefault();\n        const shouldClose = e.nativeEvent.submitter ? e.nativeEvent.submitter.dataset.close === \"true\" : true;\n        handleSubmit(e, shouldClose);\n      }\n    };\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [handleSubmit]);\n\n  // Atalho: Esc para fechar o modal\n  useEffect(() => {\n    const handleEsc = e => {\n      if (e.key === 'Escape') {\n        onClose();\n      }\n    };\n    window.addEventListener('keydown', handleEsc);\n    return () => window.removeEventListener('keydown', handleEsc);\n  }, [onClose]);\n  const setHoje = () => {\n    const hoje = new Date().toISOString().split('T')[0];\n    setData(hoje);\n  };\n  const setOntem = () => {\n    const ontem = new Date(Date.now() - 86400000).toISOString().split('T')[0];\n    setData(ontem);\n  };\n\n  // Manipula o envio do formulário, verificando o botão clicado (fechar ou continuar)\n  const onFormSubmit = e => {\n    const closeModal = e.nativeEvent.submitter.dataset.close === \"true\";\n    handleSubmit(e, closeModal);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"nova-transacao-form-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: transacao ? 'Editar Transação' : 'Nova Transação'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: onFormSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-grid\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"left-column\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Tipo:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: tipo,\n              onChange: e => setTipo(e.target.value),\n              required: true,\n              onFocus: handleFocus,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"gasto\",\n                children: \"Gasto\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"recebivel\",\n                children: \"Receb\\xEDvel\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Descri\\xE7\\xE3o:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: descricao,\n              onChange: e => setDescricao(e.target.value),\n              required: true,\n              list: \"descricao-suggestions\",\n              onFocus: handleFocus,\n              ref: descricaoRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"datalist\", {\n              id: \"descricao-suggestions\",\n              children: descricaoSuggestions.map((sug, idx) => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: sug\n              }, idx, false, {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Data:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              value: data,\n              onChange: e => setData(e.target.value),\n              required: true,\n              onFocus: handleFocus,\n              ref: dataRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"date-shortcuts\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: setHoje,\n                children: \"Hoje\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: setOntem,\n                children: \"Ontem\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Valor Total:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              step: \"0.01\",\n              value: valorTotal,\n              onChange: handleValorTotalChange,\n              required: true,\n              onFocus: handleFocus,\n              ref: valorRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"right-column\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-section pagamentos-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Pagamentos\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 15\n            }, this), pagamentos.map((pag, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pagamento-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-section\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Pessoa:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 258,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  value: pag.pessoa,\n                  onChange: e => handlePagamentoChange(index, 'pessoa', e.target.value),\n                  required: true,\n                  list: \"pessoa-suggestions\",\n                  onFocus: handleFocus\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 259,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"datalist\", {\n                  id: \"pessoa-suggestions\",\n                  children: pessoaSuggestions.map((sug, idx) => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: sug\n                  }, idx, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 269,\n                    columnNumber: 25\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 267,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-section\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Valor:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 274,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"number\",\n                  step: \"0.01\",\n                  value: pag.valor,\n                  onChange: e => handlePagamentoChange(index, 'valor', e.target.value),\n                  required: true,\n                  onFocus: handleFocus\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 275,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-section payment-tags\",\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"Tags para Pagamento\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 285,\n                  columnNumber: 21\n                }, this), categorias.map(cat => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"tag-dropdown-group\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    children: [cat.nome, \":\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 288,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                    multiple: true,\n                    value: pag.paymentTags && pag.paymentTags[cat.nome] || [],\n                    onChange: e => {\n                      const selected = Array.from(e.target.selectedOptions, opt => opt.value);\n                      handlePagamentoTagChange(index, cat.nome, selected);\n                    },\n                    onFocus: handleFocus,\n                    children: (tagsPorCategoria[cat.nome] || []).map((tagName, idx) => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: tagName,\n                      children: tagName\n                    }, idx, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 299,\n                      columnNumber: 29\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 289,\n                    columnNumber: 25\n                  }, this)]\n                }, cat._id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 287,\n                  columnNumber: 23\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: () => removePagamento(index),\n                children: \"Remover Pagamento\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 307,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 310,\n                columnNumber: 19\n              }, this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 256,\n              columnNumber: 17\n            }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: addPagamento,\n              children: \"Adicionar Pagamento\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-buttons\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          \"data-close\": \"true\",\n          className: \"submit-btn\",\n          children: transacao ? 'Atualizar e Fechar' : 'Salvar e Fechar'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          \"data-close\": \"false\",\n          className: \"submit-btn\",\n          children: transacao ? 'Atualizar e Continuar' : 'Salvar e Continuar'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 202,\n    columnNumber: 5\n  }, this);\n};\n_s(NovaTransacaoForm, \"L0Gap7bPPi3tNOMtlJfpKHk84V0=\");\n_c = NovaTransacaoForm;\nexport default NovaTransacaoForm;\nvar _c;\n$RefreshReg$(_c, \"NovaTransacaoForm\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useMemo","useCallback","criarTransacao","atualizarTransacao","obterCategorias","obterTags","jsxDEV","_jsxDEV","NovaTransacaoForm","onSuccess","onClose","transacao","_s","tipo","setTipo","descricao","setDescricao","data","setData","split","valorTotal","setValorTotal","String","valor","descricaoSuggestions","pagamentos","setPagamentos","length","pessoa","paymentTags","pessoaSuggestions","categorias","setCategorias","allTags","setAllTags","descricaoRef","dataRef","valorRef","handleFocus","e","target","scrollIntoView","behavior","block","fetchData","cats","tgs","error","console","hoje","Date","toISOString","tagsPorCategoria","reduce","acc","tag","categoria","push","nome","handlePagamentoChange","index","field","value","prev","novosPagamentos","handlePagamentoTagChange","selectedOptions","currentTags","addPagamento","removePagamento","filter","_","i","handleValorTotalChange","raw","validatePagamentos","soma","pag","v","parseFloat","isNaN","handleSubmit","closeModal","preventDefault","alert","transacaoData","Number","toFixed","tags","map","id","handleKeyDown","ctrlKey","key","shouldClose","nativeEvent","submitter","dataset","close","window","addEventListener","removeEventListener","handleEsc","setHoje","setOntem","ontem","now","onFormSubmit","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","onChange","required","onFocus","type","list","ref","sug","idx","onClick","step","cat","multiple","selected","Array","from","opt","tagName","_id","_c","$RefreshReg$"],"sources":["C:/Users/Alisson/Desktop/NEWAPP CONTROLE FINANCEIRO/controle-gastos-frontend/src/components/Transaction/NovaTransacaoForm.js"],"sourcesContent":["import React, { useEffect, useState, useRef, useMemo, useCallback } from 'react';\r\nimport { criarTransacao, atualizarTransacao, obterCategorias, obterTags } from '../../api';\r\nimport './NovaTransacaoForm.css';\r\n\r\nconst NovaTransacaoForm = ({ onSuccess, onClose, transacao }) => {\r\n  // Estados dos dados gerais\r\n  const [tipo, setTipo] = useState(transacao ? transacao.tipo : 'gasto');\r\n  const [descricao, setDescricao] = useState(transacao ? transacao.descricao : '');\r\n  const [data, setData] = useState(transacao ? transacao.data.split('T')[0] : '');\r\n  const [valorTotal, setValorTotal] = useState(transacao ? String(transacao.valor) : '');\r\n  \r\n  const descricaoSuggestions = ['Compra de pizza', 'Pagamento de conta', 'Arbitragem'];\r\n  \r\n  // Pagamentos (cada pagamento terá tags)\r\n  const [pagamentos, setPagamentos] = useState(\r\n    transacao && transacao.pagamentos && transacao.pagamentos.length > 0\r\n      ? transacao.pagamentos\r\n      : [{ pessoa: '', valor: '', paymentTags: {} }]\r\n  );\r\n  const pessoaSuggestions = ['Eu', 'Alisson', 'Emerson'];\r\n  \r\n  // Categorias e tags (para dropdowns)\r\n  const [categorias, setCategorias] = useState([]);\r\n  const [allTags, setAllTags] = useState([]);\r\n  \r\n  const descricaoRef = useRef(null);\r\n  const dataRef = useRef(null);\r\n  const valorRef = useRef(null);\r\n  \r\n  // Centraliza o campo em foco\r\n  const handleFocus = (e) => {\r\n    e.target.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n  };\r\n  \r\n  // Carrega categorias e tags do backend\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      try {\r\n        const cats = await obterCategorias();\r\n        setCategorias(cats);\r\n        const tgs = await obterTags();\r\n        setAllTags(tgs);\r\n      } catch (error) {\r\n        console.error('Erro ao carregar categorias ou tags:', error);\r\n      }\r\n    }\r\n    fetchData();\r\n    if (!transacao) {\r\n      const hoje = new Date().toISOString().split('T')[0];\r\n      setData(hoje);\r\n    }\r\n  }, [transacao]);\r\n  \r\n  // Agrupa as tags por categoria (recalculado apenas quando allTags muda)\r\n  const tagsPorCategoria = useMemo(() => {\r\n    return allTags.reduce((acc, tag) => {\r\n      if (tag.categoria) {\r\n        if (!acc[tag.categoria]) {\r\n          acc[tag.categoria] = [];\r\n        }\r\n        acc[tag.categoria].push(tag.nome);\r\n      }\r\n      return acc;\r\n    }, {});\r\n  }, [allTags]);\r\n  \r\n  // Manipulação dos pagamentos com useCallback para evitar recriação\r\n  const handlePagamentoChange = useCallback((index, field, value) => {\r\n    setPagamentos(prev => {\r\n      const novosPagamentos = [...prev];\r\n      novosPagamentos[index] = { ...novosPagamentos[index], [field]: value };\r\n      return novosPagamentos;\r\n    });\r\n  }, []);\r\n  \r\n  const handlePagamentoTagChange = useCallback((index, categoria, selectedOptions) => {\r\n    setPagamentos(prev => {\r\n      const novosPagamentos = [...prev];\r\n      const currentTags = novosPagamentos[index].paymentTags || {};\r\n      novosPagamentos[index] = {\r\n        ...novosPagamentos[index],\r\n        paymentTags: { ...currentTags, [categoria]: selectedOptions }\r\n      };\r\n      return novosPagamentos;\r\n    });\r\n  }, []);\r\n  \r\n  const addPagamento = () => {\r\n    setPagamentos(prev => [...prev, { pessoa: '', valor: '', paymentTags: {} }]);\r\n  };\r\n  \r\n  const removePagamento = (index) => {\r\n    setPagamentos(prev => prev.filter((_, i) => i !== index));\r\n  };\r\n  \r\n  // Replica o valor total para o único pagamento, se houver apenas um\r\n  const handleValorTotalChange = (e) => {\r\n    const raw = e.target.value;\r\n    setValorTotal(raw);\r\n    if (pagamentos.length === 1) {\r\n      handlePagamentoChange(0, 'valor', raw);\r\n    }\r\n  };\r\n  \r\n  // Validação: a soma dos pagamentos deve ser igual ao valor total\r\n  const validatePagamentos = () => {\r\n    const soma = pagamentos.reduce((acc, pag) => {\r\n      const v = parseFloat(pag.valor || 0);\r\n      return acc + (isNaN(v) ? 0 : v);\r\n    }, 0);\r\n    return parseFloat(valorTotal || 0) === soma;\r\n  };\r\n  \r\n  // ENVIAR FORMULÁRIO: definido antes do useEffect que o utiliza\r\n  const handleSubmit = useCallback(async (e, closeModal = true) => {\r\n    e.preventDefault();\r\n    if (!validatePagamentos()) {\r\n      alert('A soma dos pagamentos deve ser igual ao valor total.');\r\n      return;\r\n    }\r\n    const transacaoData = {\r\n      tipo,\r\n      descricao,\r\n      data: new Date(data).toISOString(),\r\n      valor: Number(parseFloat(valorTotal).toFixed(2)),\r\n      tags: {},\r\n      pagamentos: pagamentos.map(pag => ({\r\n        pessoa: pag.pessoa,\r\n        valor: Number(parseFloat(pag.valor).toFixed(2)),\r\n        tags: pag.paymentTags\r\n      }))\r\n    };\r\n    try {\r\n      if (transacao && transacao.id) {\r\n        await atualizarTransacao(transacao.id, transacaoData);\r\n        alert('Transação atualizada com sucesso!');\r\n      } else {\r\n        await criarTransacao(transacaoData);\r\n        alert('Transação criada com sucesso!');\r\n      }\r\n      if (onSuccess) onSuccess();\r\n      if (closeModal) {\r\n        onClose();\r\n      } else {\r\n        // Reseta os campos para nova inserção\r\n        setTipo('gasto');\r\n        setDescricao('');\r\n        const hoje = new Date().toISOString().split('T')[0];\r\n        setData(hoje);\r\n        setValorTotal('');\r\n        setPagamentos([{ pessoa: '', valor: '', paymentTags: {} }]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao salvar transação:', error);\r\n      alert('Erro ao salvar transação.');\r\n    }\r\n  }, [tipo, descricao, data, valorTotal, pagamentos, transacao, onSuccess, onClose]);\r\n  \r\n  // Atalho: Ctrl+S para salvar\r\n  useEffect(() => {\r\n    const handleKeyDown = (e) => {\r\n      if (e.ctrlKey && e.key === 's') {\r\n        e.preventDefault();\r\n        const shouldClose = e.nativeEvent.submitter\r\n          ? e.nativeEvent.submitter.dataset.close === \"true\"\r\n          : true;\r\n        handleSubmit(e, shouldClose);\r\n      }\r\n    };\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [handleSubmit]);\r\n  \r\n  // Atalho: Esc para fechar o modal\r\n  useEffect(() => {\r\n    const handleEsc = (e) => {\r\n      if (e.key === 'Escape') {\r\n        onClose();\r\n      }\r\n    };\r\n    window.addEventListener('keydown', handleEsc);\r\n    return () => window.removeEventListener('keydown', handleEsc);\r\n  }, [onClose]);\r\n  \r\n  const setHoje = () => {\r\n    const hoje = new Date().toISOString().split('T')[0];\r\n    setData(hoje);\r\n  };\r\n\r\n  const setOntem = () => {\r\n    const ontem = new Date(Date.now() - 86400000).toISOString().split('T')[0];\r\n    setData(ontem);\r\n  };\r\n  \r\n  // Manipula o envio do formulário, verificando o botão clicado (fechar ou continuar)\r\n  const onFormSubmit = (e) => {\r\n    const closeModal = e.nativeEvent.submitter.dataset.close === \"true\";\r\n    handleSubmit(e, closeModal);\r\n  };\r\n\r\n  return (\r\n    <div className=\"nova-transacao-form-container\">\r\n      <h2>{transacao ? 'Editar Transação' : 'Nova Transação'}</h2>\r\n      <form onSubmit={onFormSubmit}>\r\n        <div className=\"form-grid\">\r\n          <div className=\"left-column\">\r\n            <div className=\"form-section\">\r\n              <label>Tipo:</label>\r\n              <select value={tipo} onChange={e => setTipo(e.target.value)} required onFocus={handleFocus}>\r\n                <option value=\"gasto\">Gasto</option>\r\n                <option value=\"recebivel\">Recebível</option>\r\n              </select>\r\n            </div>\r\n            <div className=\"form-section\">\r\n              <label>Descrição:</label>\r\n              <input\r\n                type=\"text\"\r\n                value={descricao}\r\n                onChange={e => setDescricao(e.target.value)}\r\n                required\r\n                list=\"descricao-suggestions\"\r\n                onFocus={handleFocus}\r\n                ref={descricaoRef}\r\n              />\r\n              <datalist id=\"descricao-suggestions\">\r\n                {descricaoSuggestions.map((sug, idx) => (\r\n                  <option key={idx} value={sug} />\r\n                ))}\r\n              </datalist>\r\n            </div>\r\n            <div className=\"form-section\">\r\n              <label>Data:</label>\r\n              <input type=\"date\" value={data} onChange={e => setData(e.target.value)} required onFocus={handleFocus} ref={dataRef} />\r\n              <div className=\"date-shortcuts\">\r\n                <button type=\"button\" onClick={setHoje}>Hoje</button>\r\n                <button type=\"button\" onClick={setOntem}>Ontem</button>\r\n              </div>\r\n            </div>\r\n            <div className=\"form-section\">\r\n              <label>Valor Total:</label>\r\n              <input\r\n                type=\"number\"\r\n                step=\"0.01\"\r\n                value={valorTotal}\r\n                onChange={handleValorTotalChange}\r\n                required\r\n                onFocus={handleFocus}\r\n                ref={valorRef}\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"right-column\">\r\n            <div className=\"form-section pagamentos-section\">\r\n              <h3>Pagamentos</h3>\r\n              {pagamentos.map((pag, index) => (\r\n                <div key={index} className=\"pagamento-item\">\r\n                  <div className=\"form-section\">\r\n                    <label>Pessoa:</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={pag.pessoa}\r\n                      onChange={e => handlePagamentoChange(index, 'pessoa', e.target.value)}\r\n                      required\r\n                      list=\"pessoa-suggestions\"\r\n                      onFocus={handleFocus}\r\n                    />\r\n                    <datalist id=\"pessoa-suggestions\">\r\n                      {pessoaSuggestions.map((sug, idx) => (\r\n                        <option key={idx} value={sug} />\r\n                      ))}\r\n                    </datalist>\r\n                  </div>\r\n                  <div className=\"form-section\">\r\n                    <label>Valor:</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      step=\"0.01\"\r\n                      value={pag.valor}\r\n                      onChange={e => handlePagamentoChange(index, 'valor', e.target.value)}\r\n                      required\r\n                      onFocus={handleFocus}\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-section payment-tags\">\r\n                    <h4>Tags para Pagamento</h4>\r\n                    {categorias.map(cat => (\r\n                      <div key={cat._id} className=\"tag-dropdown-group\">\r\n                        <label>{cat.nome}:</label>\r\n                        <select\r\n                          multiple\r\n                          value={(pag.paymentTags && pag.paymentTags[cat.nome]) || []}\r\n                          onChange={e => {\r\n                            const selected = Array.from(e.target.selectedOptions, opt => opt.value);\r\n                            handlePagamentoTagChange(index, cat.nome, selected);\r\n                          }}\r\n                          onFocus={handleFocus}\r\n                        >\r\n                          {(tagsPorCategoria[cat.nome] || []).map((tagName, idx) => (\r\n                            <option key={idx} value={tagName}>\r\n                              {tagName}\r\n                            </option>\r\n                          ))}\r\n                        </select>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                  <button type=\"button\" onClick={() => removePagamento(index)}>\r\n                    Remover Pagamento\r\n                  </button>\r\n                  <hr />\r\n                </div>\r\n              ))}\r\n              <button type=\"button\" onClick={addPagamento}>\r\n                Adicionar Pagamento\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"form-buttons\">\r\n          <button type=\"submit\" data-close=\"true\" className=\"submit-btn\">\r\n            {transacao ? 'Atualizar e Fechar' : 'Salvar e Fechar'}\r\n          </button>\r\n          <button type=\"submit\" data-close=\"false\" className=\"submit-btn\">\r\n            {transacao ? 'Atualizar e Continuar' : 'Salvar e Continuar'}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NovaTransacaoForm;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}